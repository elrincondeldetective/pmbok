# backend/api/management/commands/seed_pmbok.py
from django.core.management.base import BaseCommand
from api.models import ProcessStatus, ProcessStage, PMBOKProcess

# --- NUEVA FUNCI√ìN ---
# Helper para convertir string a formato JSON [{name: "...", url: ""}]
def to_json_list(text_block):
    if not text_block or not text_block.strip():
        return []
    return [{"name": item.strip(), "url": ""} for item in text_block.split('\n') if item.strip()]

class Command(BaseCommand):
    help = 'Seeds the database with PMBOK processes, statuses, stages, and ITTOs'

    def handle(self, *args, **options):
        self.stdout.write('Deleting existing PMBOK data...')
        PMBOKProcess.objects.all().delete()
        # No borramos ProcessStatus para que se compartan con Scrum
        # ProcessStage se puede mantener o borrar, dependiendo de si cambian
        
        self.stdout.write('Creating/getting shared process statuses...')
        status_base, _ = ProcessStatus.objects.get_or_create(name="Base Estrat√©gica", defaults={'tailwind_bg_color': 'bg-indigo-800', 'tailwind_text_color': 'text-white'})
        status_sprint_cycle, _ = ProcessStatus.objects.get_or_create(name="Ciclo del Sprint", defaults={'tailwind_bg_color': 'bg-blue-700', 'tailwind_text_color': 'text-white'})
        status_daily, _ = ProcessStatus.objects.get_or_create(name="Ritmo Diario üõ†Ô∏è", defaults={'tailwind_bg_color': 'bg-green-600', 'tailwind_text_color': 'text-white'})
        status_burocracia, _ = ProcessStatus.objects.get_or_create(name="Burocracia Innecesaria", defaults={'tailwind_bg_color': 'bg-amber-500', 'tailwind_text_color': 'text-white'})
        status_inaplicable, _ = ProcessStatus.objects.get_or_create(name="Inaplicable", defaults={'tailwind_bg_color': 'bg-gray-400', 'tailwind_text_color': 'text-gray-800'})

        self.stdout.write('Creating process stages...')
        stage_map = {
            "Integraci√≥n (Inicio)": ProcessStage.objects.get_or_create(name="Integraci√≥n (Inicio)", defaults={'tailwind_bg_color': 'bg-gray-200', 'tailwind_text_color': 'text-gray-700'})[0],
            "Integraci√≥n (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Integraci√≥n (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-gray-200', 'tailwind_text_color': 'text-gray-700'})[0],
            "Integraci√≥n (Ejecuci√≥n)": ProcessStage.objects.get_or_create(name="Integraci√≥n (Ejecuci√≥n)", defaults={'tailwind_bg_color': 'bg-gray-200', 'tailwind_text_color': 'text-gray-700'})[0],
            "Integraci√≥n (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Integraci√≥n (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-gray-200', 'tailwind_text_color': 'text-gray-700'})[0],
            "Integraci√≥n (Cierre)": ProcessStage.objects.get_or_create(name="Integraci√≥n (Cierre)", defaults={'tailwind_bg_color': 'bg-gray-200', 'tailwind_text_color': 'text-gray-700'})[0],
            "Interesados (Inicio)": ProcessStage.objects.get_or_create(name="Interesados (Inicio)", defaults={'tailwind_bg_color': 'bg-purple-100', 'tailwind_text_color': 'text-purple-800'})[0],
            "Interesados (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Interesados (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-purple-100', 'tailwind_text_color': 'text-purple-800'})[0],
            "Interesados (Ejecuci√≥n)": ProcessStage.objects.get_or_create(name="Interesados (Ejecuci√≥n)", defaults={'tailwind_bg_color': 'bg-purple-100', 'tailwind_text_color': 'text-purple-800'})[0],
            "Interesados (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Interesados (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-purple-100', 'tailwind_text_color': 'text-purple-800'})[0],
            "Alcance (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Alcance (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-blue-100', 'tailwind_text_color': 'text-blue-800'})[0],
            "Alcance (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Alcance (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-blue-100', 'tailwind_text_color': 'text-blue-800'})[0],
            "Cronograma (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Cronograma (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-cyan-100', 'tailwind_text_color': 'text-cyan-800'})[0],
            "Cronograma (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Cronograma (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-cyan-100', 'tailwind_text_color': 'text-cyan-800'})[0],
            "Costos (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Costos (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-green-100', 'tailwind_text_color': 'text-green-800'})[0],
            "Costos (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Costos (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-green-100', 'tailwind_text_color': 'text-green-800'})[0],
            "Calidad (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Calidad (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-red-100', 'tailwind_text_color': 'text-red-800'})[0],
            "Calidad (Ejecuci√≥n)": ProcessStage.objects.get_or_create(name="Calidad (Ejecuci√≥n)", defaults={'tailwind_bg_color': 'bg-red-100', 'tailwind_text_color': 'text-red-800'})[0],
            "Calidad (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Calidad (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-red-100', 'tailwind_text_color': 'text-red-800'})[0],
            "Recursos (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Recursos (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-lime-100', 'tailwind_text_color': 'text-lime-800'})[0],
            "Recursos (Ejecuci√≥n)": ProcessStage.objects.get_or_create(name="Recursos (Ejecuci√≥n)", defaults={'tailwind_bg_color': 'bg-lime-100', 'tailwind_text_color': 'text-lime-800'})[0],
            "Recursos (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Recursos (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-lime-100', 'tailwind_text_color': 'text-lime-800'})[0],
            "Comunicaciones (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Comunicaciones (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-rose-100', 'tailwind_text_color': 'text-rose-800'})[0],
            "Comunicaciones (Ejecuci√≥n)": ProcessStage.objects.get_or_create(name="Comunicaciones (Ejecuci√≥n)", defaults={'tailwind_bg_color': 'bg-rose-100', 'tailwind_text_color': 'text-rose-800'})[0],
            "Comunicaciones (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Comunicaciones (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-rose-100', 'tailwind_text_color': 'text-rose-800'})[0],
            "Riesgos (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Riesgos (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-amber-100', 'tailwind_text_color': 'text-amber-800'})[0],
            "Riesgos (Ejecuci√≥n)": ProcessStage.objects.get_or_create(name="Riesgos (Ejecuci√≥n)", defaults={'tailwind_bg_color': 'bg-amber-100', 'tailwind_text_color': 'text-amber-800'})[0],
            "Riesgos (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Riesgos (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-amber-100', 'tailwind_text_color': 'text-amber-800'})[0],
            "Adquisiciones (Planeaci√≥n)": ProcessStage.objects.get_or_create(name="Adquisiciones (Planeaci√≥n)", defaults={'tailwind_bg_color': 'bg-orange-100', 'tailwind_text_color': 'text-orange-800'})[0],
            "Adquisiciones (Ejecuci√≥n)": ProcessStage.objects.get_or_create(name="Adquisiciones (Ejecuci√≥n)", defaults={'tailwind_bg_color': 'bg-orange-100', 'tailwind_text_color': 'text-orange-800'})[0],
            "Adquisiciones (Monitoreo y Control)": ProcessStage.objects.get_or_create(name="Adquisiciones (Monitoreo y Control)", defaults={'tailwind_bg_color': 'bg-orange-100', 'tailwind_text_color': 'text-orange-800'})[0],
        }
        
        full_processes_data = [
            (1, "Desarrollar el Acta de Constituci√≥n del Proyecto", "Documentos de negocio\nAcuerdos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nHabilidades interpersonales y de equipo\nReuniones", "Acta de constituci√≥n del proyecto\nRegistro de supuestos", status_base, stage_map["Integraci√≥n (Inicio)"]),
            (2, "Identificar a los Interesados", "Acta de constituci√≥n del proyecto\nDocumentos de negocio\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nAcuerdos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nRepresentaci√≥n de datos\nReuniones", "Registro de interesados\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_base, stage_map["Interesados (Inicio)"]),
            (3, "Desarrollar el Plan para la Direcci√≥n del Proyecto", "Acta de constituci√≥n del proyecto\nSalidas de otros procesos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nReuniones", "Plan para la direcci√≥n del proyecto", status_burocracia, stage_map["Integraci√≥n (Planeaci√≥n)"]),
            (4, "Planificar el Involucramiento de los Interesados", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nAcuerdos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nToma de decisiones\nRepresentaci√≥n de datos\nReuniones", "Plan de involucramiento de los interesados", status_burocracia, stage_map["Interesados (Planeaci√≥n)"]),
            (5, "Planificar la Gesti√≥n del Alcance", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de datos\nReuniones", "Plan para la gesti√≥n del alcance\nPlan de gesti√≥n de los requisitos", status_base, stage_map["Alcance (Planeaci√≥n)"]),
            (6, "Recopilar Requisitos", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDocumentos de negocio\nAcuerdos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nToma de decisiones\nRepresentaci√≥n de datos\nHabilidades interpersonales y de equipo\nDiagramas de contexto\nPrototipos", "Documentaci√≥n de requisitos\nMatriz de trazabilidad de requisitos", status_base, stage_map["Alcance (Planeaci√≥n)"]),
            (7, "Definir el Alcance", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de datos\nToma de decisiones\nHabilidades interpersonales y de equipo\nAn√°lisis del producto", "Enunciado del alcance del proyecto\nActualizaciones a los documentos del proyecto", status_base, stage_map["Alcance (Planeaci√≥n)"]),
            (8, "Crear la EDT/WBS", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nDescomposici√≥n", "L√≠nea base del alcance\nActualizaciones a los documentos del proyecto", status_base, stage_map["Alcance (Planeaci√≥n)"]),
            (9, "Planificar la Gesti√≥n del Cronograma", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de datos\nReuniones", "Plan de gesti√≥n del cronograma", status_base, stage_map["Cronograma (Planeaci√≥n)"]),
            (10, "Definir las Actividades", "Plan para la direcci√≥n del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nDescomposici√≥n\nPlanificaci√≥n gradual\nReuniones", "Lista de actividades\nAtributos de la actividad\nLista de hitos\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto", status_burocracia, stage_map["Cronograma (Planeaci√≥n)"]),
            (11, "Secuenciar las Actividades", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "M√©todo de diagramaci√≥n por precedencia\nDeterminaci√≥n e integraci√≥n de las dependencias\nAdelantos y retrasos\nSistema de informaci√≥n para la direcci√≥n de proyectos", "Diagrama de red del cronograma del proyecto\nActualizaciones a los documentos del proyecto", status_burocracia, stage_map["Cronograma (Planeaci√≥n)"]),
            (12, "Planificar la Gesti√≥n de los Riesgos", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nHerramientas y T√©cnicas", "Juicio de expertos\nAn√°lisis de datos\nReuniones", "Plan de gesti√≥n de los riesgos", status_base, stage_map["Riesgos (Planeaci√≥n)"]),
            (13, "Identificar los Riesgos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nAcuerdos\nDocumentaci√≥n de las adquisiciones\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nHabilidades interpersonales y de equipo\nListas r√°pidas\nReuniones", "Registro de riesgos\nInforme de riesgos\nActualizaciones a los documentos del proyecto", status_base, stage_map["Riesgos (Planeaci√≥n)"]),
            (14, "Realizar el An√°lisis Cualitativo de Riesgos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nHabilidades interpersonales y de equipo\nCategorizaci√≥n de riesgos\nRepresentaci√≥n de datos\nReuniones", "Actualizaciones a los documentos del proyecto", status_burocracia, stage_map["Riesgos (Planeaci√≥n)"]),
            (15, "Realizar el An√°lisis Cuantitativo de Riesgos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nRepresentaciones de la incertidumbre\nAn√°lisis de datos", "Actualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Riesgos (Planeaci√≥n)"]),
            (16, "Planificar la Respuesta a los Riesgos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nEstrategias para amenaza\nEstrategias para oportunidades\nEstrategias de respuesta a contingencias\nEstrategias para el riesgo general del proyecto\nAn√°lisis de datos\nToma de decisiones", "Solicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_burocracia, stage_map["Riesgos (Planeaci√≥n)"]),
            (17, "Planificar la Gesti√≥n de Recursos", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRepresentaci√≥n de datos\nTeor√≠a organizacional\nReuniones", "Plan de gesti√≥n de los recursos\nActa de constituci√≥n del equipo\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Recursos (Planeaci√≥n)"]),
            (18, "Estimar los Recursos de las Actividades", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nEstimaci√≥n ascendente\nEstimaci√≥n an√°loga\nEstimaci√≥n param√©trica\nAn√°lisis de datos\nSistema de informaci√≥n para la direcci√≥n de proyectos\nReuniones", "Requisitos de recursos\nBase de las estimaciones\nEstructura de desglose de recursos\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Recursos (Planeaci√≥n)"]),
            (19, "Planificar la Gesti√≥n de los Costos", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de datos\nReuniones", "Plan de gesti√≥n de los costos", status_base, stage_map["Costos (Planeaci√≥n)"]),
            (20, "Estimar los Costos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nEstimaci√≥n an√°loga\nEstimaci√≥n param√©trica\nEstimaci√≥n ascendente\nEstimaciones basadas en tres valores\nAn√°lisis de datos\nSistema de informaci√≥n para la direcci√≥n de proyectos\nToma de decisiones", "Estimaciones de costos\nBase de las estimaciones\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Costos (Planeaci√≥n)"]),
            (21, "Estimar la Duraci√≥n de las Actividades", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nEstimaci√≥n an√°loga\nEstimaci√≥n param√©trica\nEstimaciones basadas en tres valores\nEstimaci√≥n ascendente\nAn√°lisis de datos\nToma de decisiones\nReuniones", "Estimaciones de la duraci√≥n\nBase de las estimaciones\nActualizaciones a los documentos del proyecto", status_burocracia, stage_map["Cronograma (Planeaci√≥n)"]),
            (22, "Desarrollar el Cronograma", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nAcuerdos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "An√°lisis de la red del cronograma\nM√©todo de la ruta cr√≠tica\nOptimizaci√≥n de recursos\nAn√°lisis de datos\nAdelantos y retrasos\nCompresi√≥n del cronograma\nSistema de informaci√≥n para la direcci√≥n de proyectos\nPlanificaci√≥n √°gil de liberaciones", "L√≠nea base del cronograma\nCronograma del proyecto\nDatos del cronograma\nCalendarios del proyecto\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_burocracia, stage_map["Cronograma (Planeaci√≥n)"]),
            (23, "Determinar el Presupuesto", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDocumentos de negocio\nAcuerdos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nCostos agregados\nAn√°lisis de datos\nRevisar la informaci√≥n hist√≥rica\nConciliaci√≥n del l√≠mite de financiamiento\nFinanciamiento", "L√≠nea base de costos\nRequisitos de financiamiento del proyecto\nActualizaciones a los documentos del proyecto", status_base, stage_map["Costos (Planeaci√≥n)"]),
            (24, "Planificar la Gesti√≥n de la Calidad", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nToma de decisiones\nRepresentaci√≥n de datos\nPlanificaci√≥n de pruebas e inspecci√≥n\nReuniones", "Plan de gesti√≥n de la calidad\nM√©tricas de calidad\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_burocracia, stage_map["Calidad (Planeaci√≥n)"]),
            (25, "Planificar la Gesti√≥n de las Comunicaciones", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de requisitos de comunicaci√≥n\nTecnolog√≠a de la comunicaci√≥n\nModelos de comunicaci√≥n\nM√©todos de comunicaci√≥n\nHabilidades interpersonales y de equipo\nRepresentaci√≥n de datos\nReuniones", "Plan de gesti√≥n de las comunicaciones\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_burocracia, stage_map["Comunicaciones (Planeaci√≥n)"]),
            (26, "Planificar la Gesti√≥n de las Adquisiciones", "Acta de constituci√≥n del proyecto\nDocumentos de negocio\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nRecopilaci√≥n de datos\nCriterios de selecci√≥n de proveedores\nReuniones", "Plan de gesti√≥n de las adquisiciones\nEstrategia de las adquisiciones\nDocumentos de las licitaciones\nEnunciados del trabajo relativo a adquisiciones\nCriterios de selecci√≥n de proveedores\nDecisiones de hacer o comprar\nEstimaciones independientes de costos\nSolicitudes de cambio\nActualizaciones a los documentos del proyecto\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_inaplicable, stage_map["Adquisiciones (Planeaci√≥n)"]),
            (27, "Dirigir y Gestionar el Trabajo del Proyecto", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nSolicitudes de cambio aprobadas\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nSistema de informaci√≥n para la direcci√≥n de proyectos\nReuniones", "Entregables\nDatos de desempe√±o del trabajo\nRegistro de incidentes\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_daily, stage_map["Integraci√≥n (Ejecuci√≥n)"]),
            (28, "Gestionar el Conocimiento del Proyecto", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nEntregables\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nGesti√≥n del conocimiento\nGesti√≥n de la informaci√≥n\nHabilidades interpersonales y de equipo", "Registro de lecciones aprendidas\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_sprint_cycle, stage_map["Integraci√≥n (Ejecuci√≥n)"]),
            (29, "Gestionar el Involucramiento de los Interesados", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nHabilidades de comunicaci√≥n\nHabilidades interpersonales y de equipo\nReglas b√°sicas\nReuniones", "Solicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_sprint_cycle, stage_map["Interesados (Ejecuci√≥n)"]),
            (30, "Adquirir Recursos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Toma de decisiones\nHabilidades interpersonales y de equipo\nAsignaci√≥n Previa\nEquipos virtuales", "Asignaciones de recursos f√≠sicos\nAsignaciones del equipo del proyecto\nCalendarios de recursos\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto\nActualizaciones a los factores ambientales de la empresa\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_inaplicable, stage_map["Recursos (Ejecuci√≥n)"]),
            (31, "Desarrollar el Equipo", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Coubicaci√≥n\nEquipos virtuales\nTecnolog√≠a de la comunicaci√≥n\nHabilidades interpersonales y de equipo\nReconocimiento y recompensas\nCapacitaci√≥n\nEvaluaciones individuales y de equipo\nReuniones", "Evaluaciones de desempe√±o del equipo\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto\nActualizaciones a los factores ambientales de la empresa\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_burocracia, stage_map["Recursos (Ejecuci√≥n)"]),
            (32, "Dirigir al Equipo", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nInformes de desempe√±o del trabajo\nEvaluaciones de desempe√±o del equipo\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Habilidades interpersonales y de equipo\nSistema de informaci√≥n para la direcci√≥n de proyectos", "Solicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto\nActualizaciones a los factores ambientales de la empresa", status_daily, stage_map["Recursos (Ejecuci√≥n)"]),
            (34, "Efectuar las Adquisiciones", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDocumentaci√≥n de las adquisiciones\nPropuestas de los vendedores\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nPublicidad\nConferencia de oferentes\nAn√°lisis de datos\nHabilidades interpersonales y de equipo", "Vendedores seleccionados\nAcuerdos\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_inaplicable, stage_map["Adquisiciones (Ejecuci√≥n)"]),
            (36, "Implementar la Respuesta a los Riesgos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nHabilidades interpersonales y de equipo\nSistema de informaci√≥n para la direcci√≥n de proyectos", "Solicitudes de cambio\nActualizaciones a los documentos del proyecto", status_burocracia, stage_map["Riesgos (Ejecuci√≥n)"]),
            (37, "Monitorear y Controlar el Trabajo del Proyecto", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nInformaci√≥n de desempe√±o del trabajo\nAcuerdos\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de datos\nToma de decisiones\nReuniones", "Informes de desempe√±o del trabajo\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_sprint_cycle, stage_map["Integraci√≥n (Monitoreo y Control)"]),
            (38, "Realizar el Control Integrado de Cambios", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nInformes de desempe√±o del trabajo\nSolicitudes de cambio\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nHerramientas de control de cambios\nAn√°lisis de datos\nToma de decisiones\nReuniones", "Solicitudes de cambio aprobadas\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_sprint_cycle, stage_map["Integraci√≥n (Monitoreo y Control)"]),
            (40, "Controlar el Cronograma", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDatos de desempe√±o del trabajo\nActivos de los procesos de la organizaci√≥n", "An√°lisis de datos\nM√©todo de la ruta cr√≠tica\nSistema de informaci√≥n para la direcci√≥n de proyectos\nOptimizaci√≥n de recursos\nAdelantos y retrasos\nCompresi√≥n del cronograma", "Informaci√≥n de desempe√±o del trabajo\nPron√≥sticos del cronograma\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Cronograma (Monitoreo y Control)"]),
            (41, "Controlar los Costos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nRequisitos de financiamiento del proyecto\nDatos de desempe√±o del trabajo\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de datos\n√çndice de desempe√±o del trabajo por completar\nSistema de informaci√≥n para la direcci√≥n de proyectos", "Informaci√≥n de desempe√±o del trabajo\nPron√≥sticos de costos\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Costos (Monitoreo y Control)"]),
            (42, "Monitorear las Comunicaciones", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nInformes de desempe√±o del trabajo\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nSistema de informaci√≥n para la direcci√≥n de proyectos\nRepresentaci√≥n de datos\nHabilidades interpersonales y de equipo\nReuniones", "Informaci√≥n de desempe√±o del trabajo\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Comunicaciones (Monitoreo y Control)"]),
            (43, "Monitorear los Riesgos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDatos de desempe√±o del trabajo\nInformes de desempe√±o del trabajo", "An√°lisis de datos\nAuditor√≠as\nReuniones", "Informaci√≥n de desempe√±o del trabajo\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_sprint_cycle, stage_map["Riesgos (Monitoreo y Control)"]),
            (44, "Controlar los Recursos", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDatos de desempe√±o del trabajo\nAcuerdos\nActivos de los procesos de la organizaci√≥n", "An√°lisis de datos\nResoluci√≥n de problemas\nHabilidades interpersonales y de equipo\nSistema de informaci√≥n para la direcci√≥n de proyectos", "Informaci√≥n de desempe√±o del trabajo\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Recursos (Monitoreo y Control)"]),
            (45, "Controlar la Calidad", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nSolicitudes de cambio aprobadas\nEntregables\nDatos de desempe√±o del trabajo\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Recopilaci√≥n de datos\nInspecci√≥n\nPruebas/evaluaciones de productos\nRepresentaci√≥n de datos\nReuniones", "Mediciones de control de calidad\nEntregables verificados\nInformaci√≥n de desempe√±o del trabajo\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_sprint_cycle, stage_map["Calidad (Monitoreo y Control)"]),
            (46, "Validar el Alcance", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nEntregables verificados\nDatos de desempe√±o del trabajo", "Inspecci√≥n\nToma de decisiones", "Entregables aceptados\nInformaci√≥n de desempe√±o del trabajo\nSolicitudes de cambio\nActualizaciones a los documentos del proyecto", status_sprint_cycle, stage_map["Alcance (Monitoreo y Control)"]),
            (47, "Controlar el Alcance", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDatos de desempe√±o del trabajo\nActivos de los procesos de la organizaci√≥n", "An√°lisis de datos", "Informaci√≥n de desempe√±o del trabajo\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Alcance (Monitoreo y Control)"]),
            (48, "Controlar las Adquisiciones", "Plan para la direcci√≥n del proyecto\nDocumentos del proyecto\nDocumentaci√≥n de las adquisiciones\nSolicitudes de cambio aprobadas\nDatos de desempe√±o del trabajo\nFactores ambientales de la empresa\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAdministraci√≥n de reclamaciones\nAn√°lisis de datos\nInspecci√≥n\nAuditor√≠as", "Adquisiciones cerradas\nInformaci√≥n de desempe√±o del trabajo\nActualizaciones de la documentaci√≥n de las adquisiciones\nSolicitudes de cambio\nActualizaciones al plan para la direcci√≥n del proyecto\nActualizaciones a los documentos del proyecto", status_inaplicable, stage_map["Adquisiciones (Monitoreo y Control)"]),
            (49, "Cerrar el Proyecto o Fase", "Acta de constituci√≥n del proyecto\nPlan para la direcci√≥n del proyecto\nDocumentos del proyecto\nEntregables aceptados\nDocumentos de negocio\nAcuerdos\nDocumentaci√≥n de las adquisiciones\nActivos de los procesos de la organizaci√≥n", "Juicio de expertos\nAn√°lisis de datos\nReuniones", "Actualizaciones a los documentos del proyecto\nTransferencia del producto, servicio o resultado final\nInforme final\nActualizaciones a los activos de los procesos de la organizaci√≥n", status_inaplicable, stage_map["Integraci√≥n (Cierre)"]),
        ]

        self.stdout.write('Seeding PMBOK processes with all details...')
        for num, name, inputs, tools, outputs, status_obj, stage_obj in full_processes_data:
            PMBOKProcess.objects.create(
                process_number=num,
                name=name,
                inputs=to_json_list(inputs),
                tools_and_techniques=to_json_list(tools),
                outputs=to_json_list(outputs),
                status=status_obj,
                stage=stage_obj,
                # ===== CAMBIO 1 de 2: CORRECCI√ìN DEL ESTADO INICIAL =====
                # Cambiamos 'backlog' por 'unassigned' para que el tablero inicie limpio.
                kanban_status='unassigned'  
            )
        
        self.stdout.write(self.style.SUCCESS('Database has been seeded successfully with all details!'))
